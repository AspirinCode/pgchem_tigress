

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Pybel &mdash; Open Babel v2.3.0 documentation</title>
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.3.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Open Babel v2.3.0 documentation" href="../index.html" />
    <link rel="up" title="Python" href="Python.html" />
    <link rel="next" title="Pybel API" href="Python_PybelAPI.html" />
    <link rel="prev" title="The openbabel module" href="PythonDoc.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="Python_PybelAPI.html" title="Pybel API"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="PythonDoc.html" title="The openbabel module"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Open Babel v2.3.0 documentation</a> &raquo;</li>
          <li><a href="intro.html" >Write software using the Open Babel library</a> &raquo;</li>
          <li><a href="Python.html" accesskey="U">Python</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/babel130.png" alt="Logo"/>
            </a></p>
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Pybel</a><ul>
<li><a class="reference internal" href="#atoms-and-molecules">Atoms and Molecules</a></li>
<li><a class="reference internal" href="#id2">Input/Output</a></li>
<li><a class="reference internal" href="#fingerprints">Fingerprints</a></li>
<li><a class="reference internal" href="#smarts-matching">SMARTS matching</a></li>
<li><a class="reference internal" href="#combining-pybel-with-openbabel-py">Combining Pybel with openbabel.py</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="PythonDoc.html"
                        title="previous chapter">The openbabel module</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="Python_PybelAPI.html"
                        title="next chapter">Pybel API</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/UseTheLibrary/Python_Pybel.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="pybel">
<h1>Pybel<a class="headerlink" href="#pybel" title="Permalink to this headline">¶</a></h1>
<p>Pybel provides convenience functions and classes that make it
simpler to use the Open Babel libraries from Python, especially for
file input/output and for accessing the attributes of atoms and
molecules. The Atom and Molecule classes used by Pybel can be
converted to and from the OBAtom and OBMol used by the
<tt class="docutils literal"><span class="pre">openbabel</span></tt> module. These features are discussed in more detail
below.</p>
<p>The rationale and technical details behind Pybel are described in O&#8217;Boyle et al <a class="reference internal" href="#omh2008">[omh2008]</a>. To support further development of Pybel, please cite this paper if you use Pybel to obtain results for publication.</p>
<p>Information on the Pybel API can be found at the interactive Python
prompt using the <tt class="docutils literal"><span class="pre">help()</span></tt> function, and is also available in
Appendix 1 (see <em class="xref std std-ref">Pybel API</em>).</p>
<p>To use Pybel, use <tt class="docutils literal"><span class="pre">import</span> <span class="pre">pybel</span></tt> or <tt class="docutils literal"><span class="pre">from</span> <span class="pre">pybel</span> <span class="pre">import</span> <span class="pre">*</span></tt>.</p>
<table class="docutils citation" frame="void" id="omh2008" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[omh2008]</a></td><td>N.M. O&#8217;Boyle, C. Morley and G.R. Hutchison.
<strong>Pybel: a Python wrapper for the OpenBabel cheminformatics toolkit.</strong>
<em>Chem. Cent. J.</em> <strong>2008</strong>, <em>2</em>, 5.
[<a class="reference external" href="http://dx.doi.org/10.1186/1752-153X-2-5">Link</a>]</td></tr>
</tbody>
</table>
<div class="section" id="atoms-and-molecules">
<h2>Atoms and Molecules<a class="headerlink" href="#atoms-and-molecules" title="Permalink to this headline">¶</a></h2>
<p>A
<tt class="xref py py-class docutils literal"><span class="pre">Molecule</span></tt>
can be created in any of three ways:</p>
<ol class="arabic simple">
<li>From an <a class="reference external" href="http://openbabel.org/dev-api/classOpenBabel_1_1OBMol.shtml">OBMol</a>, using <tt class="docutils literal"><span class="pre">Molecule(myOBMol)</span></tt></li>
<li>By reading from a file (see <a class="reference internal" href="#id2"><em>Input/Output</em></a>
below)</li>
<li>By reading from a string (see <a class="reference internal" href="#id2"><em>Input/Output</em></a>
below)</li>
</ol>
<p>An <tt class="xref py py-class docutils literal"><span class="pre">Atom</span></tt>
be created in two different ways:</p>
<ol class="arabic simple">
<li>From an <a class="reference external" href="http://openbabel.org/dev-api/classOpenBabel_1_1OBAtom.shtml">OBAtom</a>, using <tt class="docutils literal"><span class="pre">Atom(myOBAtom)</span></tt></li>
<li>By accessing the <tt class="xref py py-attr docutils literal"><span class="pre">atoms</span></tt> attribute of a <tt class="xref py py-class docutils literal"><span class="pre">Molecule</span></tt></li>
</ol>
<div class="sidebar">
<p class="first sidebar-title">Using Pybel with openbabel.py</p>
<p class="last">It is always possible to access the OBMol or OBAtom on which a
Molecule or Atom is based, by accessing the appropriate attribute,
either <tt class="docutils literal"><span class="pre">.OBMol</span></tt> or <tt class="docutils literal"><span class="pre">.OBAtom</span></tt>. In this way, it is easy to
combine the convenience of <tt class="docutils literal"><span class="pre">pybel</span></tt> with the many additional
capabilities present in <tt class="docutils literal"><span class="pre">openbabel</span></tt>. See
<a class="reference internal" href="#combining"><em>Combining Pybel with openbabel.py</em></a>
below.</p>
</div>
<p>Molecules have the following attributes: <tt class="xref py py-attr docutils literal"><span class="pre">atoms</span></tt>, <tt class="xref py py-attr docutils literal"><span class="pre">charge</span></tt>, <tt class="xref py py-attr docutils literal"><span class="pre">data</span></tt>, <tt class="xref py py-attr docutils literal"><span class="pre">dim</span></tt>,
<tt class="xref py py-attr docutils literal"><span class="pre">energy</span></tt>, <tt class="xref py py-attr docutils literal"><span class="pre">exactmass</span></tt>, <tt class="xref py py-attr docutils literal"><span class="pre">formula</span></tt>, <tt class="xref py py-attr docutils literal"><span class="pre">molwt</span></tt>, <tt class="xref py py-attr docutils literal"><span class="pre">spin</span></tt>, <tt class="xref py py-attr docutils literal"><span class="pre">sssr</span></tt>, <tt class="xref py py-attr docutils literal"><span class="pre">title</span></tt>
and <tt class="xref py py-attr docutils literal"><span class="pre">unitcell</span></tt> (if crystal data). The <tt class="xref py py-attr docutils literal"><span class="pre">atoms</span></tt> attribute provides a
list of the Atoms in a Molecule. The <tt class="xref py py-attr docutils literal"><span class="pre">data</span></tt> attribute returns a
dictionary-like object for accessing and editing the data fields
associated with the molecule (technically, it&#8217;s a
<tt class="xref py py-class docutils literal"><span class="pre">MoleculeData</span></tt>
object, but you can use it like it&#8217;s a regular dictionary). The
<tt class="xref py py-attr docutils literal"><span class="pre">unitcell</span></tt> attribute gives access to any unit cell data
associated with the molecule (see
<a class="reference external" href="http://openbabel.org/dev-api/classOpenBabel_1_1OBUnitCell.shtml">OBUnitCell</a>).
The remaining attributes correspond directly to attributes of
OBMols: e.g. <tt class="xref py py-attr docutils literal"><span class="pre">formula</span></tt> is equivalent to
<a class="reference external" href="http://openbabel.org/dev-api/classOpenBabel_1_1OBMol.shtml#a7adc12bff502264eaebf537a5e28a43c">OBMol::GetFormula()()</a>. For more information on what these
attributes are, please see the Open Babel C++ documentation for
<a class="reference external" href="http://openbabel.org/dev-api/classOpenBabel_1_1OBMol.shtml">OBMol</a>.</p>
<p>For example, let&#8217;s suppose we have an SD file containing descriptor
values in the data fields:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">readfile</span><span class="p">(</span><span class="s">&quot;sdf&quot;</span><span class="p">,</span> <span class="s">&quot;calculatedprops.sdf&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">next</span><span class="p">()</span> <span class="c"># (readfile is described below)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">mol</span><span class="o">.</span><span class="n">molwt</span>
<span class="go">100.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span>
<span class="go">16</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">mol</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">{&#39;Comment&#39;: &#39;Created by CDK&#39;, &#39;NSC&#39;: 1, &#39;Hydrogen Bond Donors&#39;: 3, &#39;Surface Area&#39;: 342.43, .... }</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">mol</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;Hydrogen Bond Donors&#39;</span><span class="p">]</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;Random Value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span> <span class="c"># Add a descriptor containing noise</span>
</pre></div>
</div>
<p>Molecules have a <tt class="xref py py-func docutils literal"><span class="pre">write()</span></tt>
method that writes a representation of a Molecule to a file or to a
string. See <a class="reference external" href="#Input.2FOutput">Input/Output</a> below. They also have
a <tt class="xref py py-func docutils literal"><span class="pre">calcfp()</span></tt>
method that calculates a molecular fingerprint. See <a class="reference internal" href="#fingerprints-pybel"><em>Fingerprints</em></a>
below.</p>
<p>The <tt class="xref py py-func docutils literal"><span class="pre">draw()</span></tt>
method of a Molecule generates 2D coordinates and a 2D depiction of
a molecule. It uses the
<a class="reference external" href="http://bkchem.zirael.org/oasa_en.html">OASA library</a> by Beda
Kosata to do this (see the section below on
<a class="reference external" href="/wiki/Python#Installing_OASA">Installing OASA</a>). The default
options are to show the image on the screen (<tt class="docutils literal"><span class="pre">show=True</span></tt>), not to
write to a file (<tt class="docutils literal"><span class="pre">filename=None</span></tt>), to calculate 2D coordinates
(<tt class="docutils literal"><span class="pre">usecoords=False</span></tt>) but not to store them (<tt class="docutils literal"><span class="pre">update=False</span></tt>).</p>
<p>The <tt class="xref py py-func docutils literal"><span class="pre">addh()</span></tt>
and <tt class="xref py py-func docutils literal"><span class="pre">removeh()</span></tt>
methods allow hydrogens to be added and removed.</p>
<p>If a molecule does not have 3D coordinates, they can be generated
using the <tt class="xref py py-func docutils literal"><span class="pre">make3D()</span></tt>
method. By default, this includes 50 steps of a geometry
optimisation using the MMFF94 forcefield. The list of available
forcefields is stored in the
<tt class="xref py py-attr docutils literal"><span class="pre">forcefields</span></tt>
variable. To further optimise the structure, you can use the
<tt class="xref py py-func docutils literal"><span class="pre">localopt()</span></tt>
method, which by default carries out 500 steps of an optimisation
using MMFF94. Note that hydrogens need to be added before calling
<tt class="docutils literal"><span class="pre">localopt()</span></tt>.</p>
<p>The <tt class="xref py py-func docutils literal"><span class="pre">calcdesc()</span></tt>
method of a Molecule returns a dictionary containing descriptor
values for LogP, Polar Surface Area (&#8220;TPSA&#8221;) and Molar Refractivity
(&#8220;MR&#8221;). A list of the available descriptors is contained in the
variable <tt class="xref py py-data docutils literal"><span class="pre">descs</span></tt>.</p>
<p>If only one or two descriptor values are required, you can specify
the names as follows: <tt class="docutils literal"><span class="pre">calcdesc([&quot;LogP&quot;,</span> <span class="pre">&quot;TPSA&quot;])</span></tt>. Since the
<tt class="xref py py-attr docutils literal"><span class="pre">data</span></tt> attribute of a Molecule is also a dictionary, you can
easily add the result of <tt class="docutils literal"><span class="pre">calcdesc()</span></tt> to an SD file (for example)
as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">mol</span> <span class="o">=</span> <span class="n">readfile</span><span class="p">(</span><span class="s">&quot;sdf&quot;</span><span class="p">,</span> <span class="s">&quot;without_desc.sdf&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="n">descvalues</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">calcdesc</span><span class="p">()</span>
<span class="c"># In Python, the update method of a dictionary allows you</span>
<span class="c"># to add the contents of one dictionary to another</span>
<span class="n">mol</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">descvalues</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">Outputfile</span><span class="p">(</span><span class="s">&quot;sdf&quot;</span><span class="p">,</span> <span class="s">&quot;with_desc.sdf&quot;</span><span class="p">)</span>
<span class="n">output</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">output</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>For convenience, a Molecule provides an iterator over its Atoms.
This is used as follows:</p>
<div class="highlight-python"><pre>for atom in myMolecule:
   # do something with atom</pre>
</div>
<p>Atoms have the following attributes: <tt class="xref py py-attr docutils literal"><span class="pre">atomicmass</span></tt>, <tt class="xref py py-attr docutils literal"><span class="pre">atomicnum</span></tt>,
<tt class="xref py py-attr docutils literal"><span class="pre">coords</span></tt>, <tt class="xref py py-attr docutils literal"><span class="pre">exactmass</span></tt>, <tt class="xref py py-attr docutils literal"><span class="pre">formalcharge</span></tt>, <tt class="xref py py-attr docutils literal"><span class="pre">heavyvalence</span></tt>,
<tt class="xref py py-attr docutils literal"><span class="pre">heterovalence</span></tt>, <tt class="xref py py-attr docutils literal"><span class="pre">hyb</span></tt>, <tt class="xref py py-attr docutils literal"><span class="pre">idx</span></tt>, <tt class="xref py py-attr docutils literal"><span class="pre">implicitvalence</span></tt>, <tt class="xref py py-attr docutils literal"><span class="pre">isotope</span></tt>,
<tt class="xref py py-attr docutils literal"><span class="pre">partialcharge</span></tt>, <tt class="xref py py-attr docutils literal"><span class="pre">spin</span></tt>, <tt class="xref py py-attr docutils literal"><span class="pre">type</span></tt>, <tt class="xref py py-attr docutils literal"><span class="pre">valence</span></tt>, <tt class="xref py py-attr docutils literal"><span class="pre">vector</span></tt>. The <tt class="docutils literal"><span class="pre">.coords</span></tt>
attribute provides a tuple (x, y, z) of the atom&#8217;s coordinates. The
remaining attributes are as for the <em>Get</em> methods of
<a class="reference external" href="http://openbabel.org/dev-api/classOpenBabel_1_1OBAtom.shtml">OBAtom</a>.</p>
</div>
<div class="section" id="id2">
<span id="id3"></span><h2>Input/Output<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>One of the strengths of Open Babel is the number of chemical file
formats that it can handle (see <em class="xref std std-ref">file formats</em>). Pybel provides a dictionary of the
input and output formats in the variables <tt class="xref py py-attr docutils literal"><span class="pre">informats</span></tt>
and <tt class="xref py py-attr docutils literal"><span class="pre">outformats</span></tt>
where the keys are the three-letter codes for each format (e.g.
<tt class="docutils literal"><span class="pre">pdb</span></tt>) and the values are the descriptions (e.g. <tt class="docutils literal"><span class="pre">Protein</span> <span class="pre">Data</span> <span class="pre">Bank</span>
<span class="pre">format</span></tt>).</p>
<p>Pybel greatly simplifies the process of reading and writing
molecules to and from strings or files. There are two functions for
reading Molecules:</p>
<ol class="arabic simple">
<li><tt class="xref py py-func docutils literal"><span class="pre">readstring()</span></tt>
reads a Molecule from a string</li>
<li><tt class="xref py py-func docutils literal"><span class="pre">readfile()</span></tt>
provides an iterator over the Molecules in a file</li>
</ol>
<p>Here are some examples of their use. Note in particular the use of
<tt class="docutils literal"><span class="pre">.next()</span></tt> to access the first (and possibly only) molecule in a
file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">mymol</span> <span class="o">=</span> <span class="n">readstring</span><span class="p">(</span><span class="s">&quot;smi&quot;</span><span class="p">,</span> <span class="s">&quot;CCCC&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">mymol</span><span class="o">.</span><span class="n">molwt</span>
<span class="go">58</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">mymol</span> <span class="ow">in</span> <span class="n">readfile</span><span class="p">(</span><span class="s">&quot;sdf&quot;</span><span class="p">,</span> <span class="s">&quot;largeSDfile.sdf&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="k">print</span> <span class="n">mymol</span><span class="o">.</span><span class="n">molwt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">singlemol</span> <span class="o">=</span> <span class="n">readfile</span><span class="p">(</span><span class="s">&quot;pdb&quot;</span><span class="p">,</span> <span class="s">&quot;1CRN.pdb&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
</pre></div>
</div>
<p>If a single molecule is to be written to a molecule or string, the
<tt class="xref py py-func docutils literal"><span class="pre">write()</span></tt>
method of the Molecule should be used:</p>
<ol class="arabic simple">
<li><tt class="docutils literal"><span class="pre">mymol.write(format)</span></tt> returns a string</li>
<li><tt class="docutils literal"><span class="pre">mymol.write(format,</span> <span class="pre">filename)</span></tt> writes the Molecule to a file.
An optional additional parameter, <tt class="docutils literal"><span class="pre">overwrite</span></tt>, should be set to
<tt class="xref docutils literal"><span class="pre">True</span></tt> if you wish to overwrite an existing file.</li>
</ol>
<p>For files containing multiple molecules, the
<tt class="xref py py-class docutils literal"><span class="pre">Outputfile</span></tt>
class should be used instead. This is initialised with a format and
filename (and optional <tt class="docutils literal"><span class="pre">overwrite</span></tt> parameter). To write a
Molecule to the file, the
<tt class="xref py py-func docutils literal"><span class="pre">write()</span></tt>
method of the Outputfile is called with the Molecule as a
parameter. When all molecules have been written, the
<tt class="xref py py-func docutils literal"><span class="pre">close()</span></tt>
method of the Outputfile should be called.</p>
<p>Here are some examples of output using the Pybel methods and
classes:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">mymol</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;smi&quot;</span><span class="p">)</span>
<span class="go">&#39;CCCC&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mymol</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;smi&quot;</span><span class="p">,</span> <span class="s">&quot;outputfile.txt&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">largeSDfile</span> <span class="o">=</span> <span class="n">Outputfile</span><span class="p">(</span><span class="s">&quot;sdf&quot;</span><span class="p">,</span> <span class="s">&quot;multipleSD.sdf&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">largeSDfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">mymol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">largeSDfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">myothermol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">largeSDfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="fingerprints">
<span id="fingerprints-pybel"></span><h2>Fingerprints<a class="headerlink" href="#fingerprints" title="Permalink to this headline">¶</a></h2>
<p>A <tt class="xref py py-class docutils literal"><span class="pre">Fingerprint</span></tt>
can be created in either of two ways:</p>
<ol class="arabic simple">
<li>From a vector returned by the OpenBabel GetFingerprint() method,
using <tt class="docutils literal"><span class="pre">Fingerprint(myvector)</span></tt></li>
<li>By calling the <tt class="xref py py-func docutils literal"><span class="pre">calcfp()</span></tt>
method of a Molecule</li>
</ol>
<p>The <tt class="xref py py-func docutils literal"><span class="pre">calcfp()</span></tt> method takes an optional argument, <tt class="docutils literal"><span class="pre">fptype</span></tt>,
which should be one of the fingerprint types supported by OpenBabel
(see <a class="reference internal" href="../Features/Fingerprints.html#fingerprints"><em>Molecular fingerprints and similarity searching</em></a>). The
list of supported fingerprints is stored in the variable
<tt class="xref py py-attr docutils literal"><span class="pre">fps</span></tt>.
If unspecified, the default fingerprint (<tt class="docutils literal"><span class="pre">FP2</span></tt>) is calculated.</p>
<p>Once created, the Fingerprint has two attributes: <tt class="xref py py-attr docutils literal"><span class="pre">fp</span></tt> gives the
original OpenBabel vector corresponding to the fingerprint, and
<tt class="xref py py-attr docutils literal"><span class="pre">bits</span></tt> gives a list of the bits that are set.</p>
<p>The Tanimoto coefficient of two Fingerprints can be calculated
using the <tt class="docutils literal"><span class="pre">|</span></tt> operator.</p>
<p>Here is an example of its use:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pybel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">smiles</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;CCCC&#39;</span><span class="p">,</span> <span class="s">&#39;CCCN&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">pybel</span><span class="o">.</span><span class="n">readstring</span><span class="p">(</span><span class="s">&quot;smi&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">smiles</span><span class="p">]</span> <span class="c"># Create two molecules from the SMILES</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fps</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">calcfp</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">mols</span><span class="p">]</span> <span class="c"># Calculate their fingerprints</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">fps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bits</span><span class="p">,</span> <span class="n">fps</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">bits</span>
<span class="go">[261, 385, 671] [83, 261, 349, 671, 907]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">fps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">|</span> <span class="n">fps</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c"># Print the Tanimoto coefficient</span>
<span class="go">0.3333</span>
</pre></div>
</div>
</div>
<div class="section" id="smarts-matching">
<h2>SMARTS matching<a class="headerlink" href="#smarts-matching" title="Permalink to this headline">¶</a></h2>
<p>Pybel also provides a simplified API to the Open Babel SMARTS
pattern matcher. A
<tt class="xref py py-class docutils literal"><span class="pre">Smarts</span></tt>
object is created, and the
<tt class="xref py py-func docutils literal"><span class="pre">findall()</span></tt>
method is then used to return a list of the matches to a given
Molecule.</p>
<p>Here is an example of its use:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">readstring</span><span class="p">(</span><span class="s">&quot;smi&quot;</span><span class="p">,</span><span class="s">&quot;CCN(CC)CC&quot;</span><span class="p">)</span> <span class="c"># triethylamine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">smarts</span> <span class="o">=</span> <span class="n">Smarts</span><span class="p">(</span><span class="s">&quot;[#6][#6]&quot;</span><span class="p">)</span> <span class="c"># Matches an ethyl group</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">smarts</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="go">[(1, 2), (4, 5), (6, 7)]</span>
</pre></div>
</div>
</div>
<div class="section" id="combining-pybel-with-openbabel-py">
<span id="combining"></span><h2>Combining Pybel with openbabel.py<a class="headerlink" href="#combining-pybel-with-openbabel-py" title="Permalink to this headline">¶</a></h2>
<p>It is easy to combine the ease of use of Pybel, with the
comprehensive coverage of the Open Babel toolkit that
<tt class="docutils literal"><span class="pre">openbabel.py</span></tt> provides. Pybel is really a wrapper around
<tt class="docutils literal"><span class="pre">openbabel.py</span></tt>, with the result that the OBAtom and OBMol used by
openbabel.py can be interconverted to the Atom and Molecule used by
Pybel.</p>
<p>The following example shows how to read a molecule from a PDB file
using Pybel, and then how to use openbabel.py to add hydrogens. It
also illustrates how to find out information on what methods and
classes are available, while at the interactive Python prompt.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pybel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">pybel</span><span class="o">.</span><span class="n">readfile</span><span class="p">(</span><span class="s">&quot;pdb&quot;</span><span class="p">,</span> <span class="s">&quot;1PYB&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">help</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="go">Help on Molecule in module pybel object:</span>
<span class="gp">...</span>
<span class="go"> |  Attributes:</span>
<span class="go"> |     atoms, charge, dim, energy, exactmass, flags, formula,</span>
<span class="go"> |     mod, molwt, spin, sssr, title.</span>
<span class="gp">...</span>
<span class="go"> |  The original Open Babel molecule can be accessed using the attribute:</span>
<span class="go"> |     OBMol</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">atoms</span><span class="p">),</span> <span class="n">mol</span><span class="o">.</span><span class="n">molwt</span>
<span class="go">3430 49315.2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">dir</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">OBMol</span><span class="p">)</span> <span class="c"># Show the list of methods provided by openbabel.py</span>
<span class="go">[&#39;AddAtom&#39;, &#39;AddBond&#39;, &#39;AddConformer&#39;, &#39;AddHydrogens&#39;, &#39;AddPolarHydrogens&#39;, ... ]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">OBMol</span><span class="o">.</span><span class="n">AddHydrogens</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">atoms</span><span class="p">),</span> <span class="n">mol</span><span class="o">.</span><span class="n">molwt</span>
<span class="go">7244 49406.0</span>
</pre></div>
</div>
<p>The next example is an extension of one of the <tt class="docutils literal"><span class="pre">openbabel.py</span></tt>
examples at the top of this page. It shows how a molecule could be
created using <tt class="docutils literal"><span class="pre">openbabel.py</span></tt>, and then written to a file using
Pybel:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">openbabel</span><span class="o">,</span> <span class="nn">pybel</span>

<span class="n">mol</span> <span class="o">=</span> <span class="n">openbabel</span><span class="o">.</span><span class="n">OBMol</span><span class="p">()</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">NewAtom</span><span class="p">()</span>
<span class="n">a</span><span class="o">.</span><span class="n">SetAtomicNum</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>   <span class="c"># carbon atom</span>
<span class="n">a</span><span class="o">.</span><span class="n">SetVector</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span> <span class="c"># coordinates</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">NewAtom</span><span class="p">()</span>
<span class="n">mol</span><span class="o">.</span><span class="n">AddBond</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>   <span class="c"># atoms indexed from 1</span>

<span class="n">pybelmol</span> <span class="o">=</span> <span class="n">pybel</span><span class="o">.</span><span class="n">Molecule</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">pybelmol</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;sdf&quot;</span><span class="p">,</span> <span class="s">&quot;outputfile.sdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>For more examples of using Open Babel from Python, see the links on
the main <a class="reference external" href="/wiki/Python">Python</a> page.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="Python_PybelAPI.html" title="Pybel API"
             >next</a> |</li>
        <li class="right" >
          <a href="PythonDoc.html" title="The openbabel module"
             >previous</a> |</li>
        <li><a href="../index.html">Open Babel v2.3.0 documentation</a> &raquo;</li>
          <li><a href="intro.html" >Write software using the Open Babel library</a> &raquo;</li>
          <li><a href="Python.html" >Python</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2010, Open Babel community.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.1.
    </div>
  </body>
</html>